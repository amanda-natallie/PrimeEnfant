<?php ob_start();defined('BASEPATH') OR exit('No direct script access allowed');class Texto_Controller extends CI_Controller {    public function __construct() {        parent::__construct();        if (!$this->session->userdata('logado')) {            redirect(base_url('login'));        }        $this->load->model("textos_model", "mtex");    }    public function index($id) {        $this->texto = $this->mtex->lista_textos($id);        $dados['p'] = $this->session->userdata('userlogado')->user_permissao;        $dados['i'] = $id;        $dados['texto'] = $this->texto;        $dados['title'] = "Gerenciar Texto";        $dados['subtitle'] = " textos do site";        $this->load->view('backend/template/html-header', $dados);        $this->load->view('backend/template/template');        $this->load->view('backend/texto/ver');        $this->load->view('backend/template/footer');        $this->load->view('backend/template/html-footer');    }    public function inserir() {                $dados['title'] = "Admin";        $dados['subtitle'] = " textos";        $this->load->view('backend/template/html-header', $dados);        $this->load->view('backend/template/template');        $this->load->view('backend/texto/cadastrar');        $this->load->view('backend/template/footer');        $this->load->view('backend/template/html-footer');    }    public function cadastrar() {                $this->form_validation->set_rules('txt_texto', "TEXTO", array('required', 'min_length[3]'));        $this->form_validation->set_rules('txt_pagina', "PÁGINA DE DESTINO", array('required'));        $this->form_validation->set_rules('txt_localizacao', "Localização", array('required', 'min_length[3]'));               if ($this->form_validation->run() == FALSE) {            $this->inserir();        } else {            $arr_texto = [                'txt_texto' => $this->input->post('txt_texto'),                'txt_pagina' => $this->input->post('txt_pagina'),                'txt_localizacao' => $this->input->post('txt_localizacao')                ];            $retornoCad = $this->mtex->adicionar($arr_texto);                        if ($retornoCad) {                $urlRetorno = "texto/inserir/" . $this->input->post('txt_pagina');                redirect(base_url($urlRetorno));            } else {                $this->inserir();            }        }    }    public function salvar_alteracoes() {        $id = $this->input->post('txt_id');        $txt_pagina = $this->input->post('txt_pagina');                $this->form_validation->set_rules('txt_texto', "TEXTO", array('required', 'min_length[3]'));        $this->form_validation->set_rules('txt_localizacao', "Localização", array('required', 'min_length[3]'));               if ($this->form_validation->run() == FALSE) {            $this->editar($id);        } else {            $arr_texto = [                'txt_id' => $id,                'txt_texto' => $this->input->post('txt_texto'),                'txt_localizacao' => $this->input->post('txt_localizacao'),                'txt_pagina' => $txt_pagina                ];            $retornoCad = $this->mtex->editar($arr_texto);            if ($retornoCad) {                $urlRetorno = "textos/" .$txt_pagina;                redirect(base_url($urlRetorno));            } else {                $this->editar();            }        }    }    public function excluir($id) {        if ($this->mtex->excluir($id)) {            redirect(base_url("texto"));        } else {            $this->index();        }    }    public function editar($id) {        $dados['texto'] = $this->mtex->lista_texto($id);        $dados['title'] = "Admin";        $dados['subtitle'] = " Textos";        $this->load->view('backend/template/html-header', $dados);        $this->load->view('backend/template/template');        $this->load->view('backend/texto/editar');        $this->load->view('backend/template/footer');        $this->load->view('backend/template/html-footer');    }}